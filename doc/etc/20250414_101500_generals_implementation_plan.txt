# 种火集结号 - 武将系统实装计划
时间戳: 2025-04-14 10:15:00

## 已完成部分

1. 数据库设计
   - 设计了新的generals表结构
   - 设计了新的general_skills表结构
   - 保留了原有的general_assignments表结构

2. 核心类实现
   - 重新实现了General类，支持新的属性和元素系统
   - 重新实现了GeneralSkill类，支持新的技能卡牌系统

## 待实现部分

### 1. 数据库迁移（优先级：高）

1. 执行SQL脚本更新数据库结构
   - 备份原有数据
   - 创建新表结构
   - 可选：迁移现有数据

### 2. 前端页面更新（优先级：高）

1. 更新武将列表页面（generals.php）
   - 显示新的武将属性（攻击力、守备力、速度、智力）
   - 显示武将元素和COST
   - 更新稀有度显示

2. 更新武将招募页面（recruit.php）
   - 更新招募逻辑以使用新的武将生成方法
   - 显示新的武将属性和元素

3. 创建武将详情页面（general_detail.php）
   - 显示武将详细信息
   - 支持武将升级
   - 支持技能卡牌管理
   - 支持武将分配

4. 创建武将分配页面（assign_general.php）
   - 显示可分配的城池和军队
   - 支持分配和取消分配

### 3. API接口更新（优先级：中）

1. 更新武将相关API
   - 更新get_generals.php以返回新的武将属性
   - 更新recruit_general.php以使用新的武将生成方法

2. 创建技能卡牌相关API
   - 创建add_skill_card.php用于添加技能卡牌
   - 创建remove_skill_card.php用于移除技能卡牌
   - 创建upgrade_skill.php用于升级技能

3. 更新武将分配API
   - 更新assign_general.php
   - 更新unassign_general.php

### 4. 系统集成（优先级：中）

1. 更新City类
   - 修改getGeneralBonus()方法以适应新的武将加成系统
   - 更新城池相关页面以显示武将加成

2. 更新Army类
   - 修改getGeneralBonus()方法以适应新的武将加成系统
   - 更新军队相关页面以显示武将加成

3. 更新Battle类
   - 修改战斗计算逻辑以考虑新的武将属性
   - 添加技能卡牌效果应用逻辑

### 5. 测试与调试（优先级：高）

1. 单元测试
   - 测试武将创建和属性计算
   - 测试技能卡牌系统
   - 测试武将分配系统

2. 集成测试
   - 测试武将与城池/军队的交互
   - 测试武将在战斗中的表现

3. 用户界面测试
   - 测试各页面的显示和交互
   - 确保用户体验流畅

## 实施时间表

1. 数据库迁移：1天
2. 前端页面更新：3天
3. API接口更新：2天
4. 系统集成：2天
5. 测试与调试：2天

总计：10天工作时间

## 注意事项

1. 在实施过程中，需要确保向后兼容性，避免影响现有功能
2. 数据库迁移前需要做好备份
3. 前端页面更新需要考虑用户体验，提供清晰的操作指引
4. 系统集成需要全面测试，确保各模块协同工作
