# 种火集结号 - 武将系统实装记录
时间戳: 2025-04-14 12:00:00

## 已完成部分

1. 数据库设计
   - 设计了新的generals表结构
   - 设计了新的general_skills表结构
   - 保留了原有的general_assignments表结构

2. 核心类实现
   - 重新实现了General类，支持新的属性和元素系统
   - 重新实现了GeneralSkill类，支持新的技能卡牌系统
   - 更新了Resource类，添加了特定资源的增加和减少方法

3. 前端页面更新
   - 更新了武将列表页面（generals.php）
     - 显示新的武将属性（攻击力、守备力、速度、智力）
     - 显示武将元素和COST
     - 更新稀有度显示（B/A/S/SS/P）
   - 更新了武将招募页面（recruit.php）
     - 更新招募逻辑以使用新的武将生成方法
     - 更新稀有度显示和概率描述
     - 更新武将属性显示
   - 创建了武将详情页面（general_detail.php）
     - 显示武将详细信息
     - 支持武将升级
     - 支持技能卡牌管理
   - 创建了武将分配页面（assign_general.php）
     - 显示可分配的城池和军队
     - 支持分配和取消分配

## 主要变更

1. 武将属性系统
   - 从原来的五维属性（统帅、武力、智力、政治、魅力）改为新的四维属性（攻击力、守备力、速度、智力）
   - 添加了元素系统，每个武将都有一个元素属性（亮晶晶、暖洋洋、冷冰冰、郁萌萌、昼闪闪、夜静静）
   - 更新了稀有度系统，从原来的common/uncommon/rare/epic/legendary改为B/A/S/SS/P
   - 引入了COST系统，每个武将都有一个COST值，影响属性计算

2. 技能系统
   - 引入了技能卡牌概念，每个武将有一个自带技能和两个可装备技能槽位
   - 技能效果根据武将元素类型有所不同
   - 技能可以升级，每级增强20%的效果

3. 分配系统
   - 武将可以分配到城池或军队
   - 分配后的武将会提供相应的加成效果
   - 城池和军队有武将上限，与等级相关

## 待完成部分

1. API接口更新
   - 更新武将相关API
   - 创建技能卡牌相关API
   - 更新武将分配API

2. 系统集成
   - 更新City类和Army类以适应新的武将加成系统
   - 更新Battle类以支持新的武将技能系统

## 已知问题

1. Resource类中有一些未使用的变量和未定义的类型引用
2. General类中有一些未使用的变量
3. 需要实现Army类的getLevel()方法

## 后续工作

1. 修复已知问题
2. 完成API接口更新
3. 完成系统集成
4. 进行全面测试
